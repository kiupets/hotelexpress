"use strict";(self.webpackChunkkinfront=self.webpackChunkkinfront||[]).push([[733],{76733:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var s=a(65043),r=a(63336),n=a(96446),l=a(85865),o=a(77739),i=a(17392),c=a(88911),d=a(15078),h=a(84511),u=a(39336),x=a(68903),m=a(53193),j=a(79190),A=a(60598),p=a(91449),y=a(67784),g=a(43845),f=a(42518),D=a(81637),v=a(40794),b=a(40547),k=a(34759),w=a(89870),S=a(51690),C=a(41132),M=a(3021),I=a(42090),Y=a(98348),O=a(48625),P=a(86178),W=a.n(P),E=a(63046),R=a(70579);const z=()=>{const[e,t]=(0,s.useState)("custom"),[a,P]=(0,s.useState)({startDate:W()(),endDate:W()()}),[z,B]=(0,s.useState)(""),[F,H]=(0,s.useState)("detailed"),[T,L]=(0,s.useState)(!1),[N,Q]=(0,s.useState)({open:!1,message:"",severity:"success"}),[U,q]=(0,s.useState)("none"),[G,J]=(0,s.useState)({payments:!0,guests:!0,room:!0,status:!0});return(0,R.jsx)(S.$,{dateAdapter:w.A,children:(0,R.jsxs)(r.A,{sx:{p:4,maxWidth:800,margin:"auto",mt:4},children:[(0,R.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[(0,R.jsx)(l.A,{variant:"h5",children:"Reporte Financiero de Reservaciones"}),(0,R.jsx)(o.A,{title:"Restablecer filtros",children:(0,R.jsx)(i.A,{onClick:()=>{t("custom"),P({startDate:W()(),endDate:W()()}),B(""),H("detailed"),q("none"),J({payments:!0,guests:!0,room:!0,status:!0})},color:"primary",children:(0,R.jsx)(O.A,{})})})]}),(0,R.jsxs)(c.A,{spacing:4,children:[(0,R.jsxs)(n.A,{children:[(0,R.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,children:"Tipo de Reporte"}),(0,R.jsxs)(d.A,{value:F,exclusive:!0,onChange:(e,t)=>t&&H(t),fullWidth:!0,children:[(0,R.jsx)(h.A,{value:"detailed",children:(0,R.jsx)(o.A,{title:"Incluye todos los detalles y formato mejorado",children:(0,R.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(I.A,{}),"Detallado"]})})}),(0,R.jsx)(h.A,{value:"simple",children:(0,R.jsx)(o.A,{title:"Formato b\xe1sico con informaci\xf3n esencial",children:(0,R.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(M.A,{}),"Simple"]})})})]})]}),(0,R.jsx)(u.A,{}),(0,R.jsxs)(n.A,{children:[(0,R.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,children:"Per\xedodo"}),(0,R.jsxs)(x.Ay,{container:!0,spacing:2,children:[(0,R.jsx)(x.Ay,{item:!0,xs:12,md:6,children:(0,R.jsxs)(m.A,{fullWidth:!0,children:[(0,R.jsx)(j.A,{children:"Per\xedodo Predefinido"}),(0,R.jsxs)(A.A,{value:z,onChange:e=>(e=>{B(e);const t=W()();switch(e){case"today":P({startDate:t,endDate:t});break;case"yesterday":P({startDate:t.clone().subtract(1,"day"),endDate:t.clone().subtract(1,"day")});break;case"thisWeek":P({startDate:t.clone().startOf("week"),endDate:t});break;case"lastWeek":P({startDate:t.clone().subtract(1,"week").startOf("week"),endDate:t.clone().subtract(1,"week").endOf("week")});break;case"thisMonth":P({startDate:t.clone().startOf("month"),endDate:t});break;case"lastMonth":P({startDate:t.clone().subtract(1,"month").startOf("month"),endDate:t.clone().subtract(1,"month").endOf("month")});break;case"lastQuarter":P({startDate:t.clone().subtract(3,"months").startOf("month"),endDate:t.clone().subtract(1,"month").endOf("month")});break;case"thisYear":P({startDate:t.clone().startOf("year"),endDate:t})}})(e.target.value),label:"Per\xedodo Predefinido",children:[(0,R.jsx)(p.A,{value:"today",children:"Hoy"}),(0,R.jsx)(p.A,{value:"yesterday",children:"Ayer"}),(0,R.jsx)(p.A,{value:"thisWeek",children:"Esta Semana"}),(0,R.jsx)(p.A,{value:"lastWeek",children:"Semana Pasada"}),(0,R.jsx)(p.A,{value:"thisMonth",children:"Este Mes"}),(0,R.jsx)(p.A,{value:"lastMonth",children:"Mes Pasado"}),(0,R.jsx)(p.A,{value:"lastQuarter",children:"\xdaltimo Trimestre"}),(0,R.jsx)(p.A,{value:"thisYear",children:"Este A\xf1o"}),(0,R.jsx)(p.A,{value:"custom",children:"Personalizado"})]})]})}),(0,R.jsx)(x.Ay,{item:!0,xs:12,md:6,children:(0,R.jsxs)(m.A,{fullWidth:!0,children:[(0,R.jsx)(j.A,{children:"Agrupar por"}),(0,R.jsxs)(A.A,{value:U,onChange:e=>q(e.target.value),label:"Agrupar por",children:[(0,R.jsx)(p.A,{value:"none",children:"Sin agrupaci\xf3n"}),(0,R.jsx)(p.A,{value:"daily",children:"Diario"}),(0,R.jsx)(p.A,{value:"weekly",children:"Semanal"}),(0,R.jsx)(p.A,{value:"monthly",children:"Mensual"}),(0,R.jsx)(p.A,{value:"room",children:"Por Habitaci\xf3n"}),(0,R.jsx)(p.A,{value:"paymentMethod",children:"Por M\xe9todo de Pago"})]})]})})]}),"custom"===z&&(0,R.jsxs)(x.Ay,{container:!0,spacing:2,sx:{mt:2},children:[(0,R.jsx)(x.Ay,{item:!0,xs:12,md:6,children:(0,R.jsx)(k.l,{label:"Fecha Inicial",value:a.startDate,onChange:e=>P((t=>({...t,startDate:e}))),renderInput:e=>(0,R.jsx)(y.A,{...e,fullWidth:!0})})}),(0,R.jsx)(x.Ay,{item:!0,xs:12,md:6,children:(0,R.jsx)(k.l,{label:"Fecha Final",value:a.endDate,onChange:e=>P((t=>({...t,endDate:e}))),renderInput:e=>(0,R.jsx)(y.A,{...e,fullWidth:!0}),minDate:a.startDate})})]})]}),(0,R.jsx)(u.A,{}),(0,R.jsxs)(n.A,{children:[(0,R.jsxs)(l.A,{variant:"subtitle1",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:["Detalles a Incluir",(0,R.jsx)(o.A,{title:"Seleccione la informaci\xf3n que desea incluir en el reporte",children:(0,R.jsx)(Y.A,{fontSize:"small",color:"action"})})]}),(0,R.jsx)(x.Ay,{container:!0,spacing:1,children:Object.entries(G).map((e=>{let[t,a]=e;return(0,R.jsx)(x.Ay,{item:!0,children:(0,R.jsx)(g.A,{label:"payments"===t?"Pagos":"guests"===t?"Hu\xe9spedes":"room"===t?"Habitaciones":"Estado",color:a?"primary":"default",onClick:()=>J((e=>({...e,[t]:!e[t]}))),variant:a?"filled":"outlined"})},t)}))})]}),(0,R.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,R.jsx)(f.A,{variant:"contained",size:"large",startIcon:T?(0,R.jsx)(D.A,{size:20}):(0,R.jsx)(C.A,{}),onClick:async()=>{if(a.startDate&&a.endDate){L(!0);try{const t=localStorage.getItem("userId");if(!t)throw new Error("No se encontr\xf3 el ID de usuario");const s="/excel/export-".concat(F),r=await E.A.get(s,{params:{userId:t,startDate:a.startDate.format("YYYY-MM-DD"),endDate:a.endDate.format("YYYY-MM-DD"),reportType:e,groupBy:U,includeDetails:JSON.stringify(G)},responseType:"blob"}),n=window.URL.createObjectURL(new Blob([r.data])),l=document.createElement("a");l.href=n;const o="reporte-".concat(W()().format("YYYY-MM-DD"),"-").concat(F,".xlsx");l.setAttribute("download",o),document.body.appendChild(l),l.click(),l.remove(),Q({open:!0,message:"Reporte descargado exitosamente",severity:"success"})}catch(t){console.error("Error downloading report:",t),Q({open:!0,message:t.message||"Error al descargar el reporte",severity:"error"})}finally{L(!1)}}else Q({open:!0,message:"Por favor seleccione un rango de fechas",severity:"error"})},disabled:T,children:T?"Generando reporte...":"Descargar Reporte"})})]}),(0,R.jsx)(v.A,{open:N.open,autoHideDuration:6e3,onClose:()=>Q((e=>({...e,open:!1}))),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,R.jsx)(b.A,{onClose:()=>Q((e=>({...e,open:!1}))),severity:N.severity,variant:"filled",sx:{width:"100%"},children:N.message})})]})})}}}]);
//# sourceMappingURL=733.a24bbc11.chunk.js.map